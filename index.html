<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mi Página con Reproductor</title>
  <!-- Cargar CSS del reproductor -->
  <link rel="stylesheet" href="/reproductor/reproductor.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: white;
      padding: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      background: #ff0000;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }
    #openPlayerBtn {
      position: fixed;
      bottom: 80px;
      right: 20px;
      background: #222;
      border: 1px solid #ff0000;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 15px;
      border-radius: 30px;
      z-index: 1000;
    }
    #openPlayerBtn img {
      width: 24px;
      height: 24px;
    }
  </style>
</head>
<body>
  <h1>Bienvenido a mi sitio</h1>
  <p>Este es un ejemplo de página que incluye el reproductor universal cargado dinámicamente.</p>
  <button onclick="window.togglePlayer()">Abrir / Cerrar reproductor</button>
  <button onclick="playMiEpisodio()">Reproducir episodio personalizado</button>

  <!-- Botón flotante para abrir el reproductor -->
  <button id="openPlayerBtn" onclick="window.togglePlayer()">
    <img src="https://nikichitonjes-home.odoo.com/web/image/478-0e3df8d3/reanudar.gif" alt="icon">
    <span>Escuchar</span>
  </button>

  <!-- Contenedor donde se inyectará el HTML del reproductor -->
  <div id="player-container"></div>

  <!-- Script para cargar el HTML y luego el JS -->
  <script>
    // Cargar el HTML del reproductor desde el archivo externo
    fetch('/reproductor/player.html')
      .then(response => {
        if (!response.ok) throw new Error('No se pudo cargar el reproductor HTML');
        return response.text();
      })
      .then(html => {
        document.getElementById('player-container').innerHTML = html;
        // Una vez insertado el HTML, cargar el JavaScript del reproductor
        const script = document.createElement('script');
        script.src = '/reproductor/reproductor.js';
        script.onload = () => {
          console.log('Reproductor JS cargado correctamente');
          // Opcional: inicializar algo después de cargar
        };
        script.onerror = () => console.error('Error al cargar reproductor.js');
        document.body.appendChild(script);
      })
      .catch(error => {
        console.error('Error:', error);
        // Fallback: mostrar mensaje o cargar HTML directamente (opcional)
      });

    function playMiEpisodio() {
      const episodio = {
        mediaUrl: 'https://ejemplo.com/mi-audio.mp3',
        mediaType: 'audio',
        coverUrlContainer: 'https://ejemplo.com/cover-grande.jpg',
        coverUrlInfo: 'https://ejemplo.com/cover-pequeno.jpg',
        title: 'Mi episodio especial',
        detailUrl: 'https://ejemplo.com/detalle',
        author: 'Autor Ejemplo',
        next: [],
        text: 'Descripción del episodio',
        allowDownload: true,
        color: '#ff5733'
      };
      // Esperar a que el reproductor esté listo
      if (window.playExpanded) {
        window.playExpanded(episodio);
      } else {
        // Si el JS aún no ha cargado, esperar
        const checkInterval = setInterval(() => {
          if (window.playExpanded) {
            clearInterval(checkInterval);
            window.playExpanded(episodio);
          }
        }, 100);
      }
    }
  </script>
</body>
</html>
